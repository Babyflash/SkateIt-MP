<!--pages/spot/spot.wxml-->

<view class = 'container'>
  <view class="div-banner">
    <swiper
      indicator-dots="{{indicatorDots}}" 
      autoplay="{{autoplay}}" 
      circular="{{circular}}" 
      vertical="{{vertical}}"
      interval="{{interval}}" 
      duration="{{duration}}" 
      previous-margin="{{previousMargin}}px" 
      next-margin="{{nextMargin}}px"
    >
      <block wx:for="{{imgs}}" wx:for-item="img" wx:for-index="itemsIndex" wx:key="type">
        <swiper-item >
          <image class = 'div-swiper' src='{{img}}'></image>
        </swiper-item>
      </block>
    </swiper>
    <view class = 'icon-tab'>
      <image class = 'img-icon fav' src='../../lib/images/love1.svg' bindtap='doFavourite'></image>
      <button style="height: 50%; width: 50%;" open-type='share'> <image  class = 'img-icon share' src='../../lib/images/share2.svg'></image></button>
    </view>
  <view class = 'spot-type'>{{spotType}}</view>
</view>

<!-- spot info -->
<view class = "container-info">
  <view class = "div-address">
    <view class="loc-icon">
    <image class = 'img-location' src='../../lib/images/location2.png'></image>
    </view>
    <view class="address" bindtap='navigateToMap'>{{address}}</view>
  </view>
  <view class="avatar-container">
    <w-avatar size="large" src="{{createdUserAvatar}}" class = 'user-avatar'></w-avatar>
  </view>
</view>
<view class = 'div-tags'>
  <w-tag tagStyle="color:black;background-color:white;">{{spots.length}} comments</w-tag>
  <w-tag tagStyle="color:black;background-color:white;">100 likes</w-tag>
  <w-tag tagStyle="color:black;background-color:white;;">3 km</w-tag>
</view>
<view class="line"></view>

<!-- comment vertical scroll -->
  <scroll-view 
    scroll-y style="height: 45vh;" 
    bindscrolltoupper="upper" 
    bindscrolltolower="lower" 
    bindscroll="scroll" 
    scroll-into-view="{{toView}}" 
    scroll-top="{{scrollTop}}"
  >
    <block wx:for="{{spots}}" wx:for-item="spot" wx:for-index="itemsIndex" wx:key="spot">
      <comment-card avatar="{{spot.user.avatar_url}}">
        <view slot="name">{{spot.user.name}}</view>
        <view slot="date">{{spot.created_at}}</view>
        <view slot="content-body">{{spot.description}}</view>
      </comment-card>
    </block>
  </scroll-view>

  <view class="input" bindtap='showPostWindow'>
    <view class = 'div-comment'>
      <image class = 'img-comment' src='../../lib/images/comment1.svg'></image>
      <input class="weui-input comment-input" auto-focus placeholder="Leave a comment"/>
    </view>
  </view>

  <w-popup
    visible="{{ popup6 }}"
    maskCancel="{{ false }}"
    position="main"

    width="100%"
    height = '77%'
    padding="8"
    bind:onClose="handleClose"
    wuss-class="wuss-popup"
    class = 'div-popup'
  >
    <view class="demo-popup-6">
      <post bind:myevent="toggleToast" spot = '{{spot}}'></post>
    </view>
  </w-popup>

</view>